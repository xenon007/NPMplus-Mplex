# Shoes Multiplexor для NPMplus

Shoes Multiplexor - это инструмент для мультиплексирования различных протоколов на одном порту. Он позволяет использовать один порт (обычно 443) для обслуживания различных сервисов, таких как HTTPS, SSH, VLESS, VMess и других.

## Варианты развертывания

Существует два способа развертывания Shoes Multiplexor с NPMplus:

### 1. В одном контейнере с NPMplus

Этот вариант проще в настройке и управлении, так как все работает в одном контейнере.

#### Преимущества:
- Проще настройка
- Общие ресурсы
- Единая точка управления

#### Настройка:
1. Используйте образ `zoeyvid/npmplus:mplex` или соберите свой с помощью `Dockerfile.mplex`
2. Конфигурация находится в `/app/multiplexor/config.yaml` внутри контейнера
3. Управление осуществляется через веб-интерфейс NPMplus по адресу `/multiplexor`

### 2. В отдельном контейнере

Этот вариант обеспечивает лучшее разделение сервисов и может быть предпочтительнее для продакшн-окружений.

#### Преимущества:
- Лучшее разделение сервисов
- Независимое обновление компонентов
- Изоляция ресурсов

#### Настройка:
1. Используйте сервис `shoes` в файле `compose.yaml`
2. Конфигурация находится в `/opt/npmplus/multiplexor/config.yaml` на хосте
3. Управление осуществляется через веб-интерфейс NPMplus по адресу `/multiplexor`

## Конфигурация

Конфигурация Shoes Multiplexor осуществляется через веб-интерфейс NPMplus. Перейдите на страницу `/multiplexor` для управления:

1. **Настройки порта** - установите порт для прослушивания (обычно `:443`)
2. **Доступные сервисы** - выберите сервисы, которые вы хотите включить
3. **Правила мультиплексирования** - настройте детали правил перенаправления

## Поддерживаемые сервисы

- **TLS/HTTPS** - перенаправление HTTPS трафика на NPMplus
- **SSH** - перенаправление SSH трафика
- **VLESS** - перенаправление VLESS VPN трафика
- **VMess** - перенаправление VMess VPN трафика
- **Trojan** - перенаправление Trojan VPN трафика
- **HTTP Proxy** - перенаправление HTTP прокси трафика
- **SOCKS Proxy** - перенаправление SOCKS прокси трафика
- **Snell** - перенаправление Snell прокси трафика

## Примеры конфигураций

Примеры конфигураций можно найти в репозитории [cfal/shoes](https://github.com/cfal/shoes/tree/master/examples):

- [VLESS over TLS](https://github.com/cfal/shoes/blob/master/examples/vless_over_tls.yaml)
- [HTTPS](https://github.com/cfal/shoes/blob/master/examples/https.yaml)
- [TLS SNI VMess and Snell](https://github.com/cfal/shoes/blob/master/examples/tls_sni_vmess_and_snell.yaml)

## Устранение неполадок

Если у вас возникли проблемы с Shoes Multiplexor:

1. Проверьте логи контейнера NPMplus или shoes
2. Убедитесь, что порт 443 не занят другими сервисами
3. Проверьте правильность конфигурации в веб-интерфейсе
4. Убедитесь, что целевые сервисы доступны по указанным адресам
